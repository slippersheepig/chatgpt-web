<!DOCTYPE html>
<html lang="en">

<!--è‡ªé€‚åº”å±å¹•å¤§å°-->
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<meta name="description" content="ä½¿ç”¨å®˜æ–¹ChatGPT APIå®ç°ç®€å•HTMLç½‘é¡µç‰ˆåœ¨çº¿èŠå¤©ï¼ˆæ”¯æŒmarkdownè¯­æ³•åŠæŸ¥çœ‹å¯¹è¯è®°å½•ï¼‰"/>
<head>
    <meta charset="UTF-8">
    <title>OpenAI</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>
<div align="center">
    <div class="chat_window">
        <div class="top_menu">
            <div class="buttons">
                <div class="button close"></div>
                <div class="button minimize"></div>
                <div class="button maximize"></div>
            </div>
            <div class="title">ChatGPT API</div>
        </div>
        <div id="loading" style="display:none; color:red"><b>åç«¯æ­£åœ¨å¤„ç†ï¼Œè¯·ç¨ç­‰ï¼Œåˆ‡å‹¿é‡å¤æäº¤<br>è‹¥3åˆ†é’Ÿå†…æ— å“åº”åˆ™è¯´æ˜è¯·æ±‚è¶…æ—¶ï¼Œå¯åˆ·æ–°ç½‘é¡µé‡æ–°æäº¤</b></div>
        <ul class="messages">
            <div style="text-align: left; color: green">
                <pre style="white-space: pre-wrap; word-wrap:break-word" id="chatlog"></pre>
            </div>
        </ul>
        <div class="bottom_wrapper clearfix">
            <textarea class="message_input_wrapper" placeholder="ç‚¹å‡»è¿™é‡Œè¾“å…¥é—®é¢˜" id="chatinput"></textarea>
            <button class="send_message" id="sendbutton">æäº¤</button>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    // åŠ å…¥å›è½¦æäº¤æ”¯æŒï¼Œshift+å›è½¦æ¢è¡Œ
    var input = document.getElementById("chatinput");
    input.addEventListener("keydown", function (event) {
        if (event.keyCode === 13 && !event.shiftKey) {
            event.preventDefault();
            document.getElementById("sendbutton").click();
        }
    });

    // Add your JavaScript here
    document.getElementById("sendbutton").addEventListener("click", function () {
        let loading = document.getElementById('loading');
        loading.style.display = 'block';
        // Get the user's message from the input field
        var message = document.getElementById("chatinput").value;
        if (message.length < 1) {
            var response = document.createElement("div");
            response.innerHTML = "ğŸ¤”<br>ğŸ¤–<br>Message cannot be null\né—®é¢˜ä¸èƒ½ä¸ºç©º";
            chatlog.appendChild(response);
            // Scroll the chatlog to the bottom
            chatlog.scrollTop = chatlog.scrollHeight;
            loading.style.display = 'none';
        } else {
            // Clear the input field
            document.getElementById("chatinput").value = "";
            // Send the message to the chatbot
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/chat/get?msg=" + message);
            xhr.send();
            xhr.onload = function () {
                // Append the chatbot's response to the chatlog
                var chatlog = document.getElementById("chatlog");
                var response = document.createElement("div");
                response.innerHTML = "ğŸ¤”<br>" + message + "<br>ğŸ¤–" + marked.parse(xhr.responseText);
                chatlog.appendChild(response);
                // Scroll the chatlog to the bottom
                chatlog.scrollTop = chatlog.scrollHeight;
                loading.style.display = 'none';
            }
        }
    });
</script>
</body>
</html>
